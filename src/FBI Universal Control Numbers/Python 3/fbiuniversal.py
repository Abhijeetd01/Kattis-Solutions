print((lambda d, swap, x: '\n'.join([(lambda w: '{0} {1}'.format(i, sum(w[7 - j] * (27 ** j) for j in range(8)) if sum([a * b for a, b in zip(w, x)]) % 27 == w[-1] else 'Invalid'))([d[swap[c]] if c in swap else d[c] for c in input().split()[1]]) for i in range(1, int(input()) + 1)]))({b: a for a, b in enumerate('0123456789ACDEFHJKLMNPRTVWX')}, {'B': 8, 'G': 'C', 'I': '1', 'O': '0', 'Q': '0', 'S': '5', 'U': 'V', 'Y': 'V', 'Z': '2'}, [2, 4, 5, 7, 8, 10, 11, 13]))